{"ast":null,"code":"import _regeneratorRuntime from\"/www/wwwroot/cdn3.imgblur.top/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/www/wwwroot/cdn3.imgblur.top/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/www/wwwroot/cdn3.imgblur.top/web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";export default function Login(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loggedIn=_useState4[0],setLoggedIn=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),username=_useState6[0],setUsername=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),password=_useState8[0],setPassword=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),error=_useState10[0],setError=_useState10[1];var checkAuth=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var user,host,req;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!loading){_context.next=2;break;}return _context.abrupt(\"return\");case 2:setLoading(true);user=btoa(\"\".concat(username,\":\").concat(password));host=window.location.host===\"localhost:3000\"?\"http://localhost:3001\":\"\";_context.next=7;return fetch(\"\".concat(host,\"/checkAuth?basicauth=\").concat(user)).then(function(res){return res.json();});case 7:req=_context.sent;if(req[\"auth\"]){document.cookie=\"basicauth=\".concat(user);setLoggedIn(true);}else{setError(\"Wrong username or password\");setLoading(false);}case 9:case\"end\":return _context.stop();}}},_callee);}));return function checkAuth(){return _ref.apply(this,arguments);};}();if(loggedIn){window.location=\"/\";return null;}return/*#__PURE__*/React.createElement(\"div\",{className:\"login-div\"},/*#__PURE__*/React.createElement(\"h2\",{style:{textAlign:\"center\"}},\"Log in\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"username\",value:username,onChange:function onChange(e){return setUsername(e.target.value);}}),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",name:\"password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/React.createElement(\"button\",{onClick:checkAuth,disabled:loading},\"Login\"),error&&/*#__PURE__*/React.createElement(\"h4\",{style:{color:\"red\"}},error));}","map":{"version":3,"sources":["/www/wwwroot/cdn3.imgblur.top/web/src/pages/Login.js"],"names":["React","useState","Login","loading","setLoading","loggedIn","setLoggedIn","username","setUsername","password","setPassword","error","setError","checkAuth","user","btoa","host","window","location","fetch","then","res","json","req","document","cookie","textAlign","e","target","value","color"],"mappings":"qcAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CAEA,cAAe,SAASC,CAAAA,KAAT,EAAiB,eACAD,QAAQ,CAAC,KAAD,CADR,wCACvBE,OADuB,eACdC,UADc,8BAEEH,QAAQ,CAAC,KAAD,CAFV,yCAEvBI,QAFuB,eAEbC,WAFa,8BAGEL,QAAQ,CAAC,EAAD,CAHV,yCAGvBM,QAHuB,eAGbC,WAHa,8BAIEP,QAAQ,CAAC,EAAD,CAJV,yCAIvBQ,QAJuB,eAIbC,WAJa,8BAKJT,QAAQ,CAAC,EAAD,CALJ,0CAKvBU,KALuB,gBAKhBC,QALgB,gBAO9B,GAAMC,CAAAA,SAAS,0FAAG,yJACZV,OADY,iEAEhBC,UAAU,CAAC,IAAD,CAAV,CACMU,IAHU,CAGHC,IAAI,WAAIR,QAAJ,aAAgBE,QAAhB,EAHD,CAIVO,IAJU,CAIHC,MAAM,CAACC,QAAP,CAAgBF,IAAhB,GAAyB,gBAAzB,CAA4C,uBAA5C,CAAsE,EAJnE,uBAKEG,CAAAA,KAAK,WAAIH,IAAJ,iCAAgCF,IAAhC,EAAL,CAA6CM,IAA7C,CAAkD,SAACC,GAAD,QAASA,CAAAA,GAAG,CAACC,IAAJ,EAAT,EAAlD,CALF,QAKVC,GALU,eAMhB,GAAIA,GAAG,CAAC,MAAD,CAAP,CAAiB,CACfC,QAAQ,CAACC,MAAT,qBAA+BX,IAA/B,EACAR,WAAW,CAAC,IAAD,CAAX,CACD,CAHD,IAGO,CACLM,QAAQ,CAAC,4BAAD,CAAR,CACAR,UAAU,CAAC,KAAD,CAAV,CACD,CAZe,sDAAH,kBAATS,CAAAA,SAAS,0CAAf,CAeA,GAAIR,QAAJ,CAAc,CACZY,MAAM,CAACC,QAAP,CAAkB,GAAlB,CACA,MAAO,KAAP,CACD,CAED,mBACE,2BAAK,SAAS,CAAC,WAAf,eACE,0BAAI,KAAK,CAAE,CAAEQ,SAAS,CAAE,QAAb,CAAX,WADF,cAEE,6BAAO,IAAI,CAAC,MAAZ,CAAmB,IAAI,CAAC,UAAxB,CAAmC,KAAK,CAAEnB,QAA1C,CAAoD,QAAQ,CAAE,kBAACoB,CAAD,QAAOnB,CAAAA,WAAW,CAACmB,CAAC,CAACC,MAAF,CAASC,KAAV,CAAlB,EAA9D,EAFF,cAGE,6BAAO,IAAI,CAAC,UAAZ,CAAuB,IAAI,CAAC,UAA5B,CAAuC,KAAK,CAAEpB,QAA9C,CAAwD,QAAQ,CAAE,kBAACkB,CAAD,QAAOjB,CAAAA,WAAW,CAACiB,CAAC,CAACC,MAAF,CAASC,KAAV,CAAlB,EAAlE,EAHF,cAIE,8BAAQ,OAAO,CAAEhB,SAAjB,CAA4B,QAAQ,CAAEV,OAAtC,UAJF,CAOGQ,KAAK,eAAI,0BAAI,KAAK,CAAE,CAAEmB,KAAK,CAAE,KAAT,CAAX,EAA8BnB,KAA9B,CAPZ,CADF,CAWD","sourcesContent":["import React, { useState } from \"react\";\r\n\r\nexport default function Login() {\r\n  const [loading, setLoading] = useState(false);\r\n  const [loggedIn, setLoggedIn] = useState(false);\r\n  const [username, setUsername] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n\r\n  const checkAuth = async () => {\r\n    if (loading) return;\r\n    setLoading(true);\r\n    const user = btoa(`${username}:${password}`);\r\n    const host = window.location.host === \"localhost:3000\" ? \"http://localhost:3001\" : \"\";\r\n    const req = await fetch(`${host}/checkAuth?basicauth=${user}`).then((res) => res.json());\r\n    if (req[\"auth\"]) {\r\n      document.cookie = `basicauth=${user}`;\r\n      setLoggedIn(true);\r\n    } else {\r\n      setError(\"Wrong username or password\");\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (loggedIn) {\r\n    window.location = \"/\";\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"login-div\">\r\n      <h2 style={{ textAlign: \"center\" }}>Log in</h2>\r\n      <input type=\"text\" name=\"username\" value={username} onChange={(e) => setUsername(e.target.value)} />\r\n      <input type=\"password\" name=\"password\" value={password} onChange={(e) => setPassword(e.target.value)} />\r\n      <button onClick={checkAuth} disabled={loading}>\r\n        Login\r\n      </button>\r\n      {error && <h4 style={{ color: \"red\" }}>{error}</h4>}\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}